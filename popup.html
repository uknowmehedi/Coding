javascript:(function(){
  async function sleep(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
  }

  async function runAutomation() {
    const email = prompt("✉️ Enter email to invite:");
    if (!email) {
      alert("❌ No email entered.");
      return;
    }

    const tryInputEmail = () => {
      const inputs = Array.from(document.querySelectorAll("input[type='text'], input[type='email']"));
      for (let input of inputs) {
        if (
          input?.placeholder?.toLowerCase().includes("email") ||
          input?.ariaLabel?.toLowerCase().includes("email") ||
          input?.outerHTML?.includes("Notifications from the business")
        ) {
          input.focus();
          input.value = email;
          input.dispatchEvent(new Event("input", { bubbles: true }));
          return true;
        }
      }
      return false;
    };

    const tryClickByText = (label) => {
      const elements = Array.from(document.querySelectorAll("button, div[role='button']"));
      const found = elements.find(el => el.innerText.trim().toLowerCase() === label.toLowerCase());
      if (found) {
        found.click();
        return true;
      }
      return false;
    };

    const tryUncheckTempAccess = () => {
      const labels = Array.from(document.querySelectorAll("label"));
      const checkboxLabel = labels.find(l => l.innerText.toLowerCase().includes("temporary access"));
      if (checkboxLabel) {
        const checkbox = checkboxLabel.querySelector("input[type='checkbox']");
        if (checkbox?.checked) {
          checkboxLabel.click();
        }
      }
    };

    const tryClickManage = () => {
      const buttons = Array.from(document.querySelectorAll("div[role='radio'], div[role='checkbox'], div[role='button']"));
      buttons.forEach(btn => {
        const text = btn.innerText.trim().toLowerCase();
        if (text === "manage" || text === "full control") {
          btn.click();
        }
      });
    };

    const tryAdvancedOptions = async () => {
      tryClickByText("View advanced options");
      await sleep(500);
      tryClickManage(); // Manage under Finance
    };

    tryInputEmail();
    await sleep(800);

    tryUncheckTempAccess();
    await sleep(500);

    tryClickByText("Next");
    await sleep(1000);

    tryClickManage(); // Full control
    await sleep(500);

    await tryAdvancedOptions();
    await sleep(800);

    tryClickByText("Next");
    await sleep(1000);

    tryClickByText("Send invitation");
    await sleep(1000);

    tryClickByText("OK");
  }

  runAutomation();
})();
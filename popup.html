javascript:(function(){
  async function sleep(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
  }

  async function runAutomation() {
    const email = prompt("✉️ Enter email to invite:");
    if (!email) {
      alert("❌ No email entered.");
      return;
    }

    // Input email with React-compatible method
    const tryInputEmail = () => {
      const inputs = Array.from(document.querySelectorAll("input"));
      for (let input of inputs) {
        const placeholder = input.getAttribute("placeholder") || "";
        const labelText = input.closest("label")?.innerText?.toLowerCase() || "";
        if (
          placeholder.toLowerCase().includes("email") ||
          labelText.includes("email address") ||
          input.outerHTML.includes("Notifications from the business")
        ) {
          const nativeInputValueSetter = Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype, 'value')?.set;
          nativeInputValueSetter?.call(input, email);
          input.dispatchEvent(new Event('input', { bubbles: true }));
          return true;
        }
      }
      return false;
    };

    const tryClickByText = (label) => {
      const all = Array.from(document.querySelectorAll("button, div[role='button']"));
      const found = all.find(el => el.innerText.trim().toLowerCase() === label.toLowerCase());
      if (found) {
        found.click();
        return true;
      }
      return false;
    };

    const tryUncheckTempAccess = () => {
      const labels = Array.from(document.querySelectorAll("label"));
      const checkboxLabel = labels.find(l => l.innerText.toLowerCase().includes("temporary access"));
      if (checkboxLabel) {
        const checkbox = checkboxLabel.querySelector("input[type='checkbox']");
        if (checkbox?.checked) {
          checkboxLabel.click();
        }
      }
    };

    const tryClickManage = () => {
      const all = Array.from(document.querySelectorAll("div[role='checkbox'], div[role='radio'], div[role='button']"));
      all.forEach(el => {
        const text = el.innerText.trim().toLowerCase();
        if (text === "manage" || text === "full control") {
          el.click();
        }
      });
    };

    const tryAdvancedOptions = async () => {
      tryClickByText("view advanced options");
      await sleep(600);
      tryClickManage(); // Click manage under finance
    };

    tryInputEmail();
    await sleep(1000);

    tryUncheckTempAccess();
    await sleep(700);

    tryClickByText("next");
    await sleep(1200);

    tryClickManage();
    await sleep(600);

    await tryAdvancedOptions();
    await sleep(700);

    tryClickByText("next");
    await sleep(1000);

    tryClickByText("send invitation");
    await sleep(1000);

    tryClickByText("ok");
  }

  runAutomation();
})();
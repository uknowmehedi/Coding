(async () => {
  const email = prompt("Enter email to invite:");
  if (!email) return alert("No email provided!");

  const wait = (ms) => new Promise(res => setTimeout(res, ms));
  const clickByText = (txt) => {
    const el = [...document.querySelectorAll("span, div, button")]
      .find(e => e.textContent.trim() === txt);
    if (el) el.click();
  };

  const input = document.querySelector('input[aria-label="Email address"], input[type="text"]');
  if (input) {
    input.focus();
    input.value = email;
    input.dispatchEvent(new Event("input", { bubbles: true }));
  }

  await wait(1000);

  const checkbox = document.querySelector('input[type="checkbox"]:checked');
  if (checkbox) checkbox.click();

  await wait(800); clickByText("Next");
  await wait(800); clickByText("Full control");
  await wait(500); clickByText("Advanced options");
  await wait(500); clickByText("Manage");
  await wait(800); clickByText("Switch to advanced assignment");
  await wait(1000); clickByText("Select all");
  await wait(300); clickByText("Full control");
  await wait(800); clickByText("Next");
  await wait(800); clickByText("OK");
})();